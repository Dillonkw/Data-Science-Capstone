theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Boxplot for Marital Status
ggplot(CleanedData, aes(x = Marital_Status, y = BMXBMI, fill = Marital_Status)) +
geom_boxplot() +
labs(title = "BMI by Marital Status", x = "Marital Status", y = "BMI") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(dplyr)
library(ggplot2)
library(reshape2)
install.packages("reshape2")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat, Saturated_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Calcium, Iron,
Sleep_Hours, LTPA_Minutes, BMI_Class)
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat, Saturated_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Calcium, Iron, BMI)
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Calcium, Iron, BMI)
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Total_Calcium, Iron, BMI)
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Total_Calcium, Total_Iron, BMI)
# Function to plot correlation heatmap for each BMI class
plot_corr_by_class <- function(df, class_var){
classes <- unique(df[[class_var]])
for(cl in classes){
cat("Correlation Heatmap for", cl, "\n")
df_sub <- df %>% filter(!!sym(class_var) == cl) %>% select(-all_of(class_var))
corr_matrix <- cor(df_sub, use = "complete.obs")
corr_melt <- melt(corr_matrix)
ggplot(corr_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(title = paste("Correlation Heatmap -", cl), x = "", y = "") -> p
print(p)
}
}
# Run the function
plot_corr_by_class(cont_vars, "BMI_Class")
library(dplyr)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
# Example: Create BMI categories if not already
CleanedData <- CleanedData %>%
mutate(BMI_Class = case_when(
BMI < 18.5 ~ "Underweight",
BMI >= 18.5 & BMI < 25 ~ "Normal",
BMI >= 25 & BMI < 30 ~ "Overweight",
BMI >= 30 ~ "Obese"
))
# Select continuous variables of interest
cont_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat,
Vitamin_A, Vitamin_E_Alpha_Tocopherol, Total_Folate, Total_Calcium, Total_Iron, BMI)
# Function to plot correlation heatmap for each BMI class
plot_corr_by_class <- function(df, class_var){
classes <- unique(df[[class_var]])
for(cl in classes){
cat("Correlation Heatmap for", cl, "\n")
df_sub <- df %>% filter(!!sym(class_var) == cl) %>% select(-all_of(class_var))
corr_matrix <- cor(df_sub, use = "complete.obs")
corr_melt <- melt(corr_matrix)
ggplot(corr_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(title = paste("Correlation Heatmap -", cl), x = "", y = "") -> p
print(p)
}
}
# Run the function
plot_corr_by_class(cont_vars, "BMI")
CleanedData %>%
ggplot(aes(x = Gender, fill = factor(BMI))) +
geom_bar(position = "dodge") +
labs(title = "Gender Distribution by BMI Group",
x = "Gender",
y = "Count",
fill = "BMI Group") +
theme_minimal()
CleanedData %>%
ggplot(aes(x = Race, fill = factor(BMI))) +
geom_bar(position = "dodge") +
labs(title = "Gender Distribution by BMI Group",
x = "Gender",
y = "Count",
fill = "BMI Group") +
theme_minimal()
CleanedData %>%
ggplot(aes(x = factor(BMI), y = Total_Energy, fill = factor(BMI))) +
geom_boxplot() +
labs(title = "Total Energy Intake by BMI Group",
x = "BMI Group",
y = "Total Energy (kcal)",
fill = "BMI Group") +
theme_minimal()
install.packages("corrplot")
library(corrplot)
# Select numeric variables
numeric_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Fat, Total_Sat_Fat, Sleep_Hours_Weekdays, Minutes_Moderate_LTPA, Plasma_Fasting_Glucose, Insulin)
cor_matrix <- cor(numeric_vars, use = "complete.obs")
# Heatmap
corrplot(cor_matrix, method = "color", type = "upper", tl.col = "black", tl.srt = 45)
CleanedData %>%
ggplot(aes(x = Plasma_Fasting_Glucose, y = Insulin, color = factor(BMI))) +
geom_point(alpha = 0.6) +
labs(title = "Insulin vs Fasting Glucose by BMI Group",
x = "Fasting Glucose (mg/dL)",
y = "Insulin (µU/mL)",
color = "BMI Group") +
theme_minimal()
CleanedData %>%
ggplot(aes(x = Total_Fat, y = Total_Protein, color = factor(BMI))) +
geom_point(alpha = 0.6) +
labs(title = "Insulin vs Fasting Glucose by BMI Group",
x = "Fasting Glucose (mg/dL)",
y = "Insulin (µU/mL)",
color = "BMI Group") +
theme_minimal()
CleanedData %>%
ggplot(aes(x = Sleep_Hours_Weekdays, fill = factor(BMI))) +
geom_density(alpha = 0.5) +
labs(title = "Sleep Hours on Weekdays by BMI Group",
x = "Sleep Hours",
y = "Density",
fill = "BMI Group") +
theme_minimal()
numeric_vars <- CleanedData %>%
select(Total_Energy, Total_Protein, Total_Carbs, Total_Sugar, Total_Fiber,
Total_Fat, Total_Sat_Fat, Total_Mono_Sat_Fat, Total_Poly_Sat_Fat,
Total_Cholesterol, Sleep_Hours_Weekdays, Sleep_Hours_Weekends,
Minutes_Moderate_LTPA, Minutes_Vigorous_LTPA, Minutes_Sedentary_Activity,
Plasma_Fasting_Glucose, Insulin, Glycohemoglobin)
library(corrplot)
# Compute correlation
cor_matrix <- cor(numeric_vars, use = "complete.obs")
# Plot correlation matrix
corrplot(cor_matrix, method = "color", type = "upper", tl.col = "black", tl.srt = 45,
addCoef.col = "black", number.cex = 0.7)
ggplot(CleanedData, aes(x = Age)) +
geom_histogram(binwidth = 5, fill = "lightblue", color = "black") +
labs(title = "Histogram of Age", x = "Age", y = "Count")
ggplot(CleanedData, aes(x = Total_Protein)) +
geom_histogram(binwidth = 5, fill = "lightblue", color = "black") +
labs(title = "Histogram of Age", x = "Age", y = "Count")
# Macronutrients (continuous)
macros <- c("Total_Energy", "Total_Protein", "Total_Carbs", "Total_Sugar",
"Total_Fiber", "Total_Fat", "Total_Sat_Fat", "Total_Mono_Sat_Fat",
"Total_Poly_Sat_Fat", "Total_Cholesterol")
# Micronutrients (continuous)
micros <- c("Vitamin_E_Alpha_Tocopherol", "Vitamin_A", "Total_Folate",
"Added_Vitamin_B12", "Added_Alpha_Tocopherol", "Retinol",
"Alpha_Carotene", "Beta_Carotene", "Beta_Cryptoxanthin",
"Food_Folate", "Theobromine", "Iodine", "Total_Lycopene",
"Total_Lutein_Zeaxanthin", "Total_Thiamin", "Total_Riboflavin",
"Total_Niacin", "Total_VitaminB6", "Total_Folic_Acid", "Total_Folate_DFE",
"Total_Choline", "Total_VitaminB12", "Total_VitaminC",
"Total_VitaminK", "Total_VitaminD", "Total_Calcium", "Total_Phosphorus",
"Total_Magnesium", "Total_Iron", "Total_Zinc", "Total_Copper",
"Total_Sodium", "Total_Potassium", "Total_Selenium", "Total_Caffeine")
plot_distribution <- function(data, vars, type = "histogram") {
for (var in vars) {
p <- ggplot(data, aes_string(x = var)) +
theme_minimal() +
labs(title = paste("Distribution of", var), x = var, y = "Frequency")
if (type == "histogram") {
p <- p + geom_histogram(bins = 30, fill = "skyblue", color = "black")
} else if (type == "density") {
p <- p + geom_density(fill = "skyblue", alpha = 0.5)
}
print(p)
}
}
# Plot macro distributions
plot_distribution(CleanedData, macros)
# Plot micro distributions
plot_distribution(CleanedData, micros)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram()
ggplot(CleanedData, aes(x = Total_Protein)) +
geom_density(fill = "lightgreen", alpha = 0.5) +
theme_minimal() +
labs(title = "Density Plot of Total Protein", x = "Total Protein (g)", y = "Density")
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(bins = 30)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(bins = 10)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(bins = 40)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(bins = 100)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "red", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "blue", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
display.brewer.all()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#E41A1C", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#E41A1C", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#984EA3", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
install.packages("moments")
install.packages("RColorBrewer")
library(moments)
Library(RColorBrewer)
knitr::opts_chunk$set(echo = TRUE)
install.packages("moments")
install.packages("RColorBrewer")
library(moments)
library(RColorBrewer)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
library(tidyverse)
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()+
coord_cartesian(xlim = c(0, 200))
ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()+
coord_cartesian(xlim = c(0, 250))
install.packages("patchwork")
p1 <- ggplot(CleanedData, aes(x = Total_Protein)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Protein")
p2 <- ggplot(CleanedData, aes(x = Total_Carbs)) +
geom_histogram(bins = 30, fill = "lightgreen", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Carbs")
p3 <- ggplot(CleanedData, aes(x = Total_Fat)) +
geom_histogram(bins = 30, fill = "orange", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Fat")
# Combine plots in a grid (3 side by side)
combined <- p1 + p2 + p3 + plot_layout(ncol = 3)
install.packages("moments")
install.packages("RColorBrewer")
install.packages("tidyverse")
install.packages("patchwork")
knitr::opts_chunk$set(echo = TRUE)
p1 <- ggplot(CleanedData, aes(x = Total_Protein)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Protein")
install.packages("moments")
install.packages("RColorBrewer")
install.packages("tidyverse")
install.packages("patchwork")
library(moments)
library(RColorBrewer)
library(tidyverse)
library(patchwork)
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
install.packages("moments")
install.packages("RColorBrewer")
install.packages("tidyverse")
install.packages("patchwork")
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
library(moments)
library(RColorBrewer)
library(tidyverse)
library(patchwork)
CleanedData <- readRDS("CleanedData.rds")
saveRDS(CleanedData, "CleanedData.rds")
CleanedData <- readRDS("CleanedData.rds")
sum_cat_var <- CleanedData %>%
select("Gender","Race","Country_of_Origin","Education_Level","Marital_Status", "Health_Insurance",
"Thyroid_Problem","Gallstones","Liver_Condition","Taking_Treatment_Anemia", "Blood_Cholesterol_Meds",
"Told_High_BP", "Told_High_BP_2", "Attempted_Weight_Loss_Past_Year", "BMI") %>%
pivot_longer(cols = everything(), names_to = "Features", values_to = "Value") %>%
group_by(Features, Value) %>%
summarise(Frequency = n(), .groups= "drop") %>%
group_by(Features) %>%
mutate(
Percentage = Frequency / sum(Frequency) * 100,
Proportion = Frequency / sum(Frequency)
) %>%
ungroup()
sum_cat_var
sum_con_var <- CleanedData %>%
select("Age", "Household_Size", "Family_Income_to_Poverty_Ratio", "Total_Energy", "Total_Protein", "Total_Carbs", "Total_Sugar", "Total_Fiber", "Total_Fat",
"Total_Sat_Fat", "Total_Mono_Sat_Fat", "Total_Poly_Sat_Fat", "Total_Cholesterol", "Total_Lycopene", "Total_Lutein_Zeaxanthin", "Total_Thiamin", "Total_Riboflavin",
"Total_Niacin", "Total_VitaminB6", "Total_Folic_Acid", "Total_Folate_DFE", "Total_Choline", "Total_VitaminB12", "Total_VitaminC", "Total_VitaminK", "Total_VitaminD",
"Total_Calcium", "Total_Phosphorus", "Total_Magnesium", "Total_Iron", "Total_Zinc", "Total_Copper", "Total_Sodium","Total_Potassium", "Total_Selenium", "Total_Caffeine",
"Vitamin_E_Alpha_Tocopherol", "Added_Alpha_Tocopherol", "Retinol", "Vitamin_A", "Alpha_Carotene", "Beta_Carotene", "Beta_Cryptoxanthin",
"Total_Folate", "Food_Folate", "Added_Vitamin_B12", "Theobromine", "Alcohol", "Moisture", "Total_Plain_Water", "Iodine", "Plasma_Fasting_Glucose",
"Insulin", "Glycohemoglobin", "Sleep_Hours_Weekdays", "Sleep_Hours_Weekends", "Minutes_Moderate_LTPA", "Minutes_Vigorous_LTPA", "Minutes_Sedentary_Activity",) %>%
summarize(across(everything(),
list(
Mean = ~mean(.x, na.rm = TRUE),
Median = ~median(.x, na.rm = TRUE),
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
Sd = ~sd(.x, na.rm = TRUE),
Skew = ~skewness(.x, na.rm = TRUE),
Kurtosis = ~kurtosis(.x, na.rm = TRUE)
), .names = "{col}_{fn}"
)) %>%
pivot_longer(everything(),
names_to = c("features", "Statistic"),
names_sep = "_(?=[^_]+$)",
values_to = "Value") %>%
pivot_wider(names_from = Statistic, values_from = Value)
sum_con_var
p1 <- ggplot(CleanedData, aes(x = Total_Protein)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Protein")
p2 <- ggplot(CleanedData, aes(x = Total_Carbs)) +
geom_histogram(bins = 30, fill = "lightgreen", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Carbs")
p3 <- ggplot(CleanedData, aes(x = Total_Fat)) +
geom_histogram(bins = 30, fill = "orange", color = "black") +
xlim(0, 200) +
theme_minimal() +
labs(title = "Total Fat")
# Combine plots in a grid (3 side by side)
combined <- p1 + p2 + p3 + plot_layout(ncol = 3)
combined
#Total Protein Distribution
g1 <- ggplot(CleanedData, aes(x = Total_Protein))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Protein Distribution",
x = " Total Protein",
y = "Count"
)+
theme_minimal()
# Total Carbs Distribution
g2 <- ggplot(CleanedData, aes(x = Total_Carbs))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Carbs Distribution",
x = " Total carbs",
y = "Count"  )+
theme_minimal()
#Total Fats Distribution
g3 <- ggplot(CleanedData, aes(x = Total_Fat))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Fat =Distribution",
x = " Total Fat",
y = "Count"
)+
theme_minimal()
#Water Distribution
g4 <- ggplot(CleanedData, aes(x = Total_Plain_Water))+
geom_histogram(fill = "#377EB8", color = "black")+
labs(
title = "Total Water Distribution",
x = " Total Water",
y = "Count"
)+
theme_minimal()
merge = g1 + g2 +g3 + g4 + plot_layout(ncol = 4)
merge
